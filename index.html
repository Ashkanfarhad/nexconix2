<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=no">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="theme-color" content="#0a0e17">
<title>NexCoinX</title>
<script>
(function(){function tryLoad(u,i){if(i>=u.length)return;var s=document.createElement("script");s.src=u[i];s.onload=function(){window._lwcOK=true;if(window._lwcReady)window._lwcReady();};s.onerror=function(){tryLoad(u,i+1);};document.head.appendChild(s);}
tryLoad(["https://unpkg.com/lightweight-charts@4.1.1/dist/lightweight-charts.standalone.production.js","https://cdn.jsdelivr.net/npm/lightweight-charts@4.1.1/dist/lightweight-charts.standalone.production.js"],0);
})();
</script>
<style>
@import url("https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:wght@400;600&family=Plus+Jakarta+Sans:wght@400;500;600;700;800&display=swap");
:root{
  --bg:#0a0e17;--bg2:#0d1220;--bg3:#111827;--bg4:#1a2235;
  --b1:rgba(255,255,255,.07);--b2:rgba(255,255,255,.13);
  --ye:#f0b90b;--ye2:#fcd535;--gr:#0ecb81;--re:#f6465d;--bl:#1890ff;--pu:#9b59b6;
  --tx:#eaecef;--t2:#b7bdc6;--t3:#707a8a;--t4:#3d4d5e;
  --mn:"IBM Plex Mono",monospace;--sn:"Plus Jakarta Sans",sans-serif;
  --r:8px;--r2:14px;--nb:60px;--nt:60px;
}
*{margin:0;padding:0;box-sizing:border-box;-webkit-tap-highlight-color:transparent;}
html{font-size:14px;}
body{font-family:var(--sn);background:var(--bg);color:var(--tx);min-height:100vh;min-height:100dvh;overflow-x:hidden;}
body.ku{font-family:"Segoe UI",Tahoma,sans-serif;}
::-webkit-scrollbar{width:3px;height:3px;}::-webkit-scrollbar-thumb{background:var(--b2);border-radius:99px;}
/* TICKER */
.ticker-wrap{background:var(--bg2);border-bottom:1px solid var(--b1);overflow:hidden;height:28px;display:flex;align-items:center;}
.ticker-inner{display:flex;animation:tkr 28s linear infinite;white-space:nowrap;}
.ticker-inner:hover{animation-play-state:paused;}
@keyframes tkr{0%{transform:translateX(0)}100%{transform:translateX(-50%)}}
.ti{display:inline-flex;align-items:center;gap:6px;padding:0 16px;font-family:var(--mn);font-size:.7rem;border-inline-end:1px solid var(--b1);}
.ti-up{color:var(--gr);}.ti-dn{color:var(--re);}
/* TOP NAV */
#top-nav{height:var(--nt);background:rgba(13,18,32,.95);backdrop-filter:blur(12px);-webkit-backdrop-filter:blur(12px);border-bottom:1px solid var(--b1);display:none;align-items:center;padding:0 16px;position:sticky;top:0;z-index:200;gap:10px;}
.nav-logo{font-family:var(--mn);font-size:.98rem;font-weight:600;cursor:pointer;display:flex;align-items:center;gap:6px;flex-shrink:0;}
.nav-logo .dot{width:8px;height:8px;border-radius:50%;background:var(--ye);}
.nav-tabs{display:flex;gap:1px;flex:1;overflow-x:auto;scrollbar-width:none;}
.nav-tabs::-webkit-scrollbar{display:none;}
.nav-tab{padding:7px 10px;border-radius:var(--r);cursor:pointer;color:var(--t3);font-size:.76rem;font-weight:500;transition:.15s;white-space:nowrap;flex-shrink:0;}
.nav-tab:hover{color:var(--tx);background:var(--bg3);}
.nav-tab.on{color:var(--ye);background:rgba(240,185,11,.07);}
.nav-right{display:flex;align-items:center;gap:6px;flex-shrink:0;}
.bal-chip{background:var(--bg3);border:1px solid var(--b1);border-radius:var(--r);padding:5px 10px;display:flex;align-items:center;gap:6px;cursor:pointer;}
.bal-chip .lbl{color:var(--t3);font-size:.62rem;}.bal-chip .amt{font-family:var(--mn);font-weight:700;color:var(--ye);font-size:.8rem;}
.icon-btn{width:34px;height:34px;border-radius:var(--r);background:var(--bg3);border:1px solid var(--b1);display:flex;align-items:center;justify-content:center;cursor:pointer;position:relative;transition:.15s;flex-shrink:0;}
.icon-btn:hover{border-color:var(--ye);}
.ndot{position:absolute;top:3px;inset-inline-end:3px;width:7px;height:7px;border-radius:50%;background:var(--re);border:2px solid var(--bg2);display:none;}
.ndot.on{display:block;}
/* BUTTONS */
.btn{padding:10px 16px;border-radius:var(--r);font-family:var(--sn);font-size:.82rem;font-weight:600;cursor:pointer;border:none;transition:.15s;display:inline-flex;align-items:center;justify-content:center;gap:5px;white-space:nowrap;}
.btn-ye{background:var(--ye);color:#0a0e17;}.btn-ye:hover{background:var(--ye2);}.btn-ye:active{transform:scale(.97);}
.btn-gh{background:transparent;border:1px solid var(--b2);color:var(--t2);}.btn-gh:hover{color:var(--tx);}
.btn-gr{background:rgba(14,203,129,.12);border:1px solid rgba(14,203,129,.25);color:var(--gr);}
.btn-re{background:rgba(246,70,93,.12);border:1px solid rgba(246,70,93,.25);color:var(--re);}
.btn-sm{padding:7px 12px;font-size:.77rem;}.btn-xs{padding:4px 9px;font-size:.72rem;}.btn-full{width:100%;justify-content:center;}
/* FORMS */
.fg{margin-bottom:12px;}
.fg label{display:block;font-size:.67rem;text-transform:uppercase;letter-spacing:.06em;color:var(--t3);margin-bottom:5px;}
.fg input,.fg select,.fg textarea{width:100%;padding:12px 13px;background:var(--bg3);border:1.5px solid var(--b1);border-radius:var(--r);color:var(--tx);font-family:var(--sn);font-size:.88rem;outline:none;transition:.15s;-webkit-appearance:none;appearance:none;}
.fg input:focus,.fg select:focus,.fg textarea:focus{border-color:var(--ye);background:var(--bg);}
.fg select option{background:var(--bg2);}.fg textarea{resize:vertical;min-height:70px;}
/* AUTH */
#auth-screen{min-height:100dvh;display:flex;align-items:center;justify-content:center;padding:20px;background:radial-gradient(ellipse 90% 60% at 50% -5%,rgba(240,185,11,.07) 0%,transparent 65%);}
.auth-wrap{width:100%;max-width:400px;}
.auth-logo-big{font-family:var(--mn);font-size:1.5rem;font-weight:600;display:flex;align-items:center;justify-content:center;gap:8px;}
.auth-logo-big .dot{width:10px;height:10px;border-radius:50%;background:var(--ye);}
.auth-card{background:var(--bg2);border:1px solid var(--b1);border-radius:var(--r2);overflow:hidden;margin-top:20px;}
.auth-tabs{display:grid;grid-template-columns:1fr 1fr;border-bottom:1px solid var(--b1);}
.atb{padding:13px;text-align:center;cursor:pointer;font-weight:700;color:var(--t3);transition:.15s;font-size:.875rem;border-bottom:2px solid transparent;}
.atb.on{color:var(--ye);border-bottom-color:var(--ye);}
.auth-body{padding:22px;}
/* APP */
#app-screen{display:none;}
.app-wrap{display:flex;flex-direction:column;}
.app-inner{display:grid;grid-template-columns:195px 1fr;}
.sidebar{background:var(--bg2);border-inline-end:1px solid var(--b1);position:sticky;top:var(--nt);height:calc(100dvh - var(--nt));overflow-y:auto;padding:12px 9px;}
.sbg{margin-bottom:18px;}.sbl{font-size:.6rem;text-transform:uppercase;letter-spacing:.1em;color:var(--t4);padding:0 8px;margin-bottom:5px;}
.sbk{display:flex;align-items:center;gap:9px;padding:9px 10px;border-radius:var(--r);cursor:pointer;color:var(--t3);font-size:.8rem;font-weight:500;transition:.15s;margin-bottom:1px;}
.sbk:hover{background:var(--bg3);color:var(--tx);}.sbk.on{background:rgba(240,185,11,.09);color:var(--ye);}
.sbk svg{width:14px;height:14px;flex-shrink:0;}
.sb-badge{margin-inline-start:auto;background:var(--re);color:#fff;font-size:.58rem;padding:2px 6px;border-radius:99px;font-weight:700;}
.app-main{overflow-y:auto;}
/* BOTTOM NAV mobile */
#bottom-nav{display:none;position:fixed;bottom:0;left:0;right:0;height:var(--nb);background:rgba(13,18,32,.97);backdrop-filter:blur(16px);-webkit-backdrop-filter:blur(16px);border-top:1px solid var(--b1);z-index:300;padding-bottom:env(safe-area-inset-bottom);}
.bn-inner{display:flex;height:100%;align-items:center;}
.bn-item{flex:1;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:2px;cursor:pointer;color:var(--t3);transition:.15s;padding:4px 2px;position:relative;}
.bn-item.on{color:var(--ye);}
.bn-item svg{width:20px;height:20px;}
.bn-item span{font-size:.57rem;font-weight:600;white-space:nowrap;}
.bn-dot{position:absolute;top:3px;inset-inline-end:calc(50% - 16px);width:7px;height:7px;border-radius:50%;background:var(--re);border:2px solid var(--bg2);display:none;}
.bn-dot.on{display:block;}
/* PAGES */
.pg{display:none;}.pg.on{display:block;}
.pi{padding:18px 20px;}
/* TRADE */
.mkt-hdr{background:var(--bg2);border-bottom:1px solid var(--b1);padding:10px 14px;display:flex;align-items:center;gap:10px;flex-wrap:wrap;}
.mkt-grid{display:grid;grid-template-columns:155px 1fr 265px;height:calc(100dvh - var(--nt) - 53px);overflow:hidden;}
.coins-col{border-inline-end:1px solid var(--b1);background:var(--bg2);overflow-y:auto;}
.cs-hdr{padding:7px 9px;border-bottom:1px solid var(--b1);}
.cs-srch{display:flex;align-items:center;gap:5px;background:var(--bg3);border-radius:var(--r);padding:6px 9px;}
.cs-srch input{flex:1;background:none;border:none;outline:none;color:var(--tx);font-size:.78rem;min-width:0;}
.cli{display:flex;align-items:center;padding:9px;cursor:pointer;transition:.13s;border-bottom:1px solid rgba(255,255,255,.02);}
.cli:hover,.cli:active{background:var(--bg3);}.cli.on{background:rgba(240,185,11,.05);}
.chart-col{border-inline-end:1px solid var(--b1);display:flex;flex-direction:column;overflow:hidden;}
.chart-tb{display:flex;align-items:center;gap:7px;padding:7px 13px;border-bottom:1px solid var(--b1);background:var(--bg2);flex-shrink:0;}
.chart-tb .clbl{color:var(--t3);font-size:.7rem;}
.ct-btn{padding:3px 9px;border-radius:5px;font-size:.7rem;font-weight:600;cursor:pointer;border:1px solid var(--b1);background:transparent;color:var(--t3);transition:.13s;}
.ct-btn.on{background:rgba(240,185,11,.1);border-color:var(--ye);color:var(--ye);}
#trade-wrap{flex:1;position:relative;min-height:0;}
#trade-chart{position:absolute;inset:0;}
.order-col{display:flex;flex-direction:column;background:var(--bg2);overflow:hidden;}
.ttype-row{display:grid;grid-template-columns:1fr 1fr;margin:12px 12px 0;background:var(--bg3);border-radius:var(--r);padding:3px;}
.ttb{padding:8px;text-align:center;border-radius:6px;cursor:pointer;font-weight:700;font-size:.82rem;color:var(--t3);transition:.15s;}
.ttb.buy.on{background:rgba(14,203,129,.12);color:var(--gr);}.ttb.sell.on{background:rgba(246,70,93,.12);color:var(--re);}
.order-body{padding:12px;flex:1;overflow-y:auto;}
.tinw{position:relative;margin-bottom:9px;}
.tinw input{width:100%;padding:11px 46px 11px 13px;background:var(--bg);border:1.5px solid var(--b1);border-radius:var(--r);color:var(--tx);font-family:var(--mn);font-size:.88rem;outline:none;transition:.15s;}
.tinw input:focus{border-color:var(--ye);}
.tinw .sfx{position:absolute;inset-inline-end:11px;top:50%;transform:translateY(-50%);color:var(--t3);font-size:.72rem;font-family:var(--mn);}
.tir{display:flex;justify-content:space-between;font-size:.74rem;margin-bottom:5px;}
.tir .k{color:var(--t3);}.tir .v{font-family:var(--mn);}
.exec-btn{width:100%;padding:12px;border-radius:var(--r);border:none;font-family:var(--sn);font-size:.9rem;font-weight:700;cursor:pointer;transition:.15s;margin-top:10px;}
.exec-btn:active{transform:scale(.98);}
.exec-btn.buy{background:var(--gr);color:#fff;}.exec-btn.sell{background:var(--re);color:#fff;}
.side-hold{padding:11px;overflow-y:auto;border-top:1px solid var(--b1);}
/* CHARTS PAGE */
.charts-pg-hdr{padding:16px 20px 8px;display:flex;align-items:center;justify-content:space-between;gap:10px;flex-wrap:wrap;}
.charts-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(360px,1fr));gap:14px;padding:0 20px 20px;}
.chart-card{background:var(--bg2);border:1px solid var(--b1);border-radius:var(--r2);overflow:hidden;}
.chart-card-hdr{padding:11px 14px;border-bottom:1px solid var(--b1);display:flex;align-items:center;gap:9px;}
.cc-ico{width:32px;height:32px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:.9rem;flex-shrink:0;}
.chart-type-badge{display:inline-block;font-size:.58rem;padding:1px 6px;border-radius:99px;font-weight:700;letter-spacing:.04em;margin-inline-start:4px;vertical-align:middle;}
.ct-candle{background:rgba(240,185,11,.12);color:var(--ye);}.ct-line{background:rgba(24,144,255,.12);color:var(--bl);}
.chart-card-chart{height:185px;position:relative;}
.chart-card-chart>div{position:absolute;inset:0;}
.chart-card-foot{padding:9px 13px;border-top:1px solid var(--b1);display:flex;align-items:center;justify-content:space-between;}
/* STATS */
.stats-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:10px;margin-bottom:16px;}
.sbox{background:var(--bg2);border:1px solid var(--b1);border-radius:var(--r2);padding:14px;}
.sbox .sl{color:var(--t3);font-size:.69rem;margin-bottom:4px;}.sbox .sv{font-family:var(--mn);font-size:1.2rem;font-weight:700;}.sbox .sh{color:var(--t3);font-size:.67rem;margin-top:3px;}
/* TABLES */
.sec-box{background:var(--bg2);border:1px solid var(--b1);border-radius:var(--r2);overflow:hidden;margin-bottom:14px;}
.sec-hdr{padding:11px 15px;border-bottom:1px solid var(--b1);display:flex;align-items:center;justify-content:space-between;}
.sec-ttl{font-weight:700;font-size:.87rem;}
table{width:100%;border-collapse:collapse;}
th{text-align:start;padding:9px 15px;font-size:.63rem;text-transform:uppercase;letter-spacing:.05em;color:var(--t3);border-bottom:1px solid var(--b1);}
td{padding:10px 15px;border-bottom:1px solid rgba(255,255,255,.02);font-size:.81rem;vertical-align:middle;}
tr:last-child td{border-bottom:none;}tr:hover td{background:rgba(255,255,255,.01);}
.badge{display:inline-block;padding:2px 8px;border-radius:4px;font-size:.66rem;font-weight:700;font-family:var(--mn);}
.bg{background:rgba(14,203,129,.1);color:var(--gr);}.br{background:rgba(246,70,93,.1);color:var(--re);}.bo{background:rgba(240,185,11,.1);color:var(--ye);}.bb{background:rgba(24,144,255,.1);color:var(--bl);}
/* MESSAGES */
.msg-layout{display:grid;grid-template-columns:230px 1fr;height:calc(100dvh - var(--nt));}
.msg-list{background:var(--bg2);border-inline-end:1px solid var(--b1);overflow-y:auto;display:flex;flex-direction:column;}
.ml-hdr{padding:13px 14px;border-bottom:1px solid var(--b1);font-weight:700;flex-shrink:0;}
.mli{padding:11px 13px;border-bottom:1px solid rgba(255,255,255,.02);cursor:pointer;transition:.14s;display:flex;gap:9px;}
.mli:hover,.mli:active{background:var(--bg3);}.mli.on{background:rgba(240,185,11,.04);}
.mli.unread .mli-nm{color:var(--ye);}
.mli-av{width:35px;height:35px;border-radius:50%;background:linear-gradient(135deg,rgba(240,185,11,.3),rgba(240,185,11,.1));display:flex;align-items:center;justify-content:center;font-weight:700;font-size:.85rem;flex-shrink:0;}
.mli-nm{font-weight:600;font-size:.8rem;margin-bottom:2px;}
.mli-pv{color:var(--t3);font-size:.7rem;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:120px;}
.mli-tm{color:var(--t4);font-size:.62rem;margin-inline-start:auto;white-space:nowrap;}
.msg-chat{display:flex;flex-direction:column;background:var(--bg);overflow:hidden;}
.mc-hdr{padding:11px 15px;border-bottom:1px solid var(--b1);background:var(--bg2);display:flex;align-items:center;gap:9px;flex-shrink:0;}
.mc-av{width:34px;height:34px;border-radius:50%;background:linear-gradient(135deg,rgba(240,185,11,.3),rgba(240,185,11,.1));display:flex;align-items:center;justify-content:center;font-weight:700;font-size:.85rem;}
.mc-nm{font-weight:700;font-size:.87rem;}.mc-st{color:var(--gr);font-size:.7rem;}
.mc-body{flex:1;overflow-y:auto;padding:13px 15px;display:flex;flex-direction:column;gap:9px;}
.bubble{max-width:72%;padding:9px 12px;border-radius:11px;font-size:.83rem;line-height:1.55;word-break:break-word;}
.bubble.adm{background:var(--bg3);border:1px solid var(--b1);align-self:flex-start;border-end-start-radius:3px;}
.bubble.adm::before{content:"Admin";display:block;color:var(--ye);font-size:.6rem;font-weight:700;margin-bottom:3px;text-transform:uppercase;letter-spacing:.04em;}
.bubble.me{background:rgba(240,185,11,.09);border:1px solid rgba(240,185,11,.15);align-self:flex-end;border-end-end-radius:3px;}
.btime{font-size:.6rem;color:var(--t4);margin-top:3px;text-align:end;}
.mc-foot{padding:10px 13px;border-top:1px solid var(--b1);background:var(--bg2);display:flex;gap:7px;align-items:flex-end;flex-shrink:0;}
.mc-foot textarea{flex:1;padding:9px 11px;background:var(--bg3);border:1.5px solid var(--b1);border-radius:var(--r);color:var(--tx);font-family:var(--sn);font-size:.83rem;resize:none;outline:none;max-height:100px;transition:.15s;}
.mc-foot textarea:focus{border-color:var(--ye);}
.no-chat{display:flex;align-items:center;justify-content:center;flex:1;color:var(--t4);flex-direction:column;gap:10px;text-align:center;padding:20px;}
/* PROFILE */
.prof-grid{display:grid;grid-template-columns:250px 1fr;gap:14px;}
.prof-card{background:var(--bg2);border:1px solid var(--b1);border-radius:var(--r2);padding:22px;text-align:center;}
.pav-wrap{position:relative;display:inline-block;margin-bottom:13px;}
.pav{width:70px;height:70px;border-radius:50%;background:linear-gradient(135deg,rgba(240,185,11,.2),rgba(240,185,11,.05));display:flex;align-items:center;justify-content:center;font-size:1.5rem;font-weight:700;overflow:hidden;border:2px solid rgba(240,185,11,.2);}
.pav img{width:100%;height:100%;object-fit:cover;}
.pav-edit{position:absolute;bottom:0;inset-inline-end:0;width:22px;height:22px;border-radius:50%;background:var(--ye);display:flex;align-items:center;justify-content:center;cursor:pointer;font-size:.7rem;color:#000;}
.pname{font-weight:800;font-size:1rem;margin-bottom:3px;}.pemail{color:var(--t3);font-size:.78rem;margin-bottom:15px;}
.prow{display:flex;justify-content:space-between;padding:9px 0;border-bottom:1px solid var(--b1);font-size:.81rem;}
.prow:last-child{border-bottom:none;}.prow .pk{color:var(--t3);}.prow .pv{font-family:var(--mn);font-weight:600;}
/* SETTINGS */
.settings-grid{display:grid;grid-template-columns:1fr 1fr;gap:14px;}
.setting-card{background:var(--bg2);border:1px solid var(--b1);border-radius:var(--r2);padding:17px;}
.setting-card h4{font-weight:700;font-size:.87rem;margin-bottom:12px;}
.lang-opts{display:grid;grid-template-columns:1fr 1fr;gap:9px;}
.lang-opt{background:var(--bg3);border:1.5px solid var(--b1);border-radius:var(--r);padding:13px;cursor:pointer;text-align:center;transition:.15s;}
.lang-opt:hover{border-color:var(--ye);}.lang-opt.on{border-color:var(--ye);background:rgba(240,185,11,.05);}
.lang-opt .lf{font-size:1.7rem;margin-bottom:4px;}.lang-opt .ln{font-weight:700;font-size:.82rem;}.lang-opt .lk{color:var(--t3);font-size:.7rem;}
.sw{width:42px;height:23px;background:var(--bg3);border-radius:12px;position:relative;cursor:pointer;transition:.2s;border:1px solid var(--b1);}
.sw.on{background:var(--ye);}.sw::after{content:"";position:absolute;width:17px;height:17px;border-radius:50%;background:#fff;top:2px;inset-inline-start:2px;transition:.2s;}.sw.on::after{inset-inline-start:21px;}
/* ALERTS PAGE */
.alert-card{background:var(--bg2);border:1px solid var(--b1);border-radius:var(--r2);padding:14px;display:flex;align-items:center;gap:12px;margin-bottom:10px;}
.alert-card.triggered{border-color:var(--ye);}
/* MODALS */
.ovl{display:none;position:fixed;inset:0;background:rgba(0,0,0,.85);z-index:500;align-items:flex-end;justify-content:center;backdrop-filter:blur(10px);-webkit-backdrop-filter:blur(10px);}
.ovl.show{display:flex;}
@media(min-width:640px){.ovl{align-items:center;padding:20px;}}
.modal{background:var(--bg2);border:1px solid var(--b2);border-radius:var(--r2) var(--r2) 0 0;width:100%;max-width:500px;max-height:92dvh;overflow-y:auto;animation:slideup .25s ease;}
@media(min-width:640px){.modal{border-radius:var(--r2);animation:mup .2s ease;}}
@keyframes slideup{from{transform:translateY(100%)}to{transform:translateY(0)}}
@keyframes mup{from{transform:translateY(10px);opacity:0}to{transform:translateY(0);opacity:1}}
.mdrag{width:38px;height:4px;border-radius:99px;background:var(--b2);margin:8px auto 0;}
@media(min-width:640px){.mdrag{display:none;}}
.mhdr{padding:13px 16px;border-bottom:1px solid var(--b1);display:flex;align-items:center;justify-content:space-between;}
.mhdr h3{font-weight:700;font-size:.9rem;}
.mclose{width:25px;height:25px;border-radius:5px;background:var(--bg3);border:1px solid var(--b1);cursor:pointer;display:flex;align-items:center;justify-content:center;color:var(--t3);font-size:.8rem;transition:.13s;}
.mclose:hover{color:var(--tx);}
.mbody{padding:15px;}
.dep-steps{display:flex;align-items:center;margin-bottom:18px;}
.ds{display:flex;align-items:center;gap:4px;font-size:.73rem;color:var(--t3);}
.dsn{width:21px;height:21px;border-radius:50%;background:var(--bg3);border:1px solid var(--b2);display:flex;align-items:center;justify-content:center;font-size:.65rem;font-weight:700;flex-shrink:0;}
.ds.on .dsn{background:var(--ye);color:var(--bg);border-color:var(--ye);}.ds.on{color:var(--tx);}
.ds.done .dsn{background:var(--gr);color:var(--bg);border-color:var(--gr);}
.dsl{flex:1;height:1px;background:var(--b1);margin:0 4px;}
.pay-meths{display:grid;grid-template-columns:1fr 1fr 1fr;gap:8px;margin-bottom:13px;}
.pmeth{background:var(--bg3);border:1.5px solid var(--b1);border-radius:var(--r);padding:11px 8px;cursor:pointer;text-align:center;transition:.15s;position:relative;}
.pmeth:hover,.pmeth:active{border-color:var(--ye);}.pmeth.sel{border-color:var(--ye);background:rgba(240,185,11,.06);}
.pmeth.disabled{opacity:.4;cursor:not-allowed;pointer-events:none;}
.pm-nm{font-weight:700;font-size:.78rem;margin-bottom:2px;}.pm-url{color:var(--t3);font-size:.63rem;}
.soon-badge{display:inline-block;background:rgba(240,185,11,.12);color:var(--ye);font-size:.57rem;padding:1px 5px;border-radius:99px;font-weight:700;}
.acct-box{background:var(--bg3);border:1px solid var(--b1);border-radius:var(--r);padding:12px 14px;margin-bottom:12px;}
.acct-box .abt{color:var(--t3);font-size:.65rem;text-transform:uppercase;letter-spacing:.05em;margin-bottom:6px;}
.acct-num{font-family:var(--mn);font-size:1.1rem;font-weight:700;color:var(--ye);letter-spacing:2px;}
.warn-box{background:rgba(240,185,11,.06);border:1px solid rgba(240,185,11,.18);border-radius:var(--r);padding:10px 12px;margin-bottom:12px;display:flex;gap:8px;font-size:.77rem;color:var(--t2);line-height:1.5;}
.upload-zone{border:2px dashed var(--b2);border-radius:var(--r);padding:22px 16px;text-align:center;cursor:pointer;transition:.15s;position:relative;}
.upload-zone:hover,.upload-zone:active{border-color:var(--ye);}
.upload-zone.has-file{border-color:var(--gr);background:rgba(14,203,129,.03);}
.upload-zone input{position:absolute;inset:0;opacity:0;cursor:pointer;width:100%;height:100%;}
.sum-row{display:flex;justify-content:space-between;padding:7px 0;border-bottom:1px solid var(--b1);font-size:.81rem;}
.sum-row:last-child{border-bottom:none;}.sum-row .sk{color:var(--t3);}
/* TOAST */
.toast{position:fixed;top:68px;inset-inline-end:14px;z-index:9999;background:var(--bg2);border:1px solid var(--b2);border-radius:var(--r);padding:10px 14px;display:flex;align-items:center;gap:7px;box-shadow:0 8px 30px rgba(0,0,0,.6);transform:translateX(calc(100% + 20px));transition:transform .25s cubic-bezier(.34,1.56,.64,1);max-width:290px;font-size:.8rem;}
.toast.show{transform:translateX(0);}
[dir=rtl] .toast{transform:translateX(calc(-100% - 20px));}[dir=rtl] .toast.show{transform:translateX(0);}
/* RESPONSIVE */
@media(max-width:767px){
  .sidebar{display:none!important;}
  .app-inner{grid-template-columns:1fr!important;}
  #bottom-nav{display:block;}
  .app-main{padding-bottom:var(--nb);}
  .mkt-grid{grid-template-columns:1fr;height:auto;}
  .coins-col{display:none;}
  .chart-col{height:240px;border-inline-end:none;border-bottom:1px solid var(--b1);}
  .order-col{height:auto;}
  .ttype-row{margin:10px;}
  .order-body{padding:10px;}
  .side-hold{display:none;}
  .stats-grid{grid-template-columns:1fr 1fr;}
  .pi{padding:13px;}
  .charts-grid{grid-template-columns:1fr;padding:0 13px 70px;}
  .charts-pg-hdr{padding:12px 13px 4px;}
  .prof-grid{grid-template-columns:1fr;}
  .settings-grid{grid-template-columns:1fr;}
  .msg-layout{grid-template-columns:1fr;height:calc(100dvh - var(--nt) - var(--nb));}
  .msg-list{display:none;}.msg-list.show{display:flex;}
  .msg-chat{height:calc(100dvh - var(--nt) - var(--nb));}
  .nav-tabs{display:none;}
  .nav-right .btn-ye,.nav-right .btn-gh{display:none;}
  table{font-size:.73rem;}th,td{padding:8px 9px;}
  .ovl{padding:0;}
}
@media(min-width:768px) and (max-width:1100px){
  .mkt-grid{grid-template-columns:145px 1fr 245px;}
  .stats-grid{grid-template-columns:repeat(4,1fr);}
}
@media(min-width:1101px){.stats-grid{grid-template-columns:repeat(4,1fr);}}
</style>
</head>
<body>
<!-- AUTH -->
<div id="auth-screen">
 <div class="auth-wrap">
  <div style="text-align:center;margin-bottom:4px;">
   <div style="font-size:2rem;margin-bottom:8px;">üíé</div>
   <div class="auth-logo-big"><div class="dot"></div>NexCoinX</div>
   <p style="color:var(--t3);font-size:.8rem;margin-top:4px;">Professional Crypto Exchange</p>
  </div>
  <div class="auth-card">
   <div class="auth-tabs">
    <div class="atb on" id="atb-l" onclick="switchAuth('l')">Log In</div>
    <div class="atb" id="atb-r" onclick="switchAuth('r')">Sign Up</div>
   </div>
   <div class="auth-body" id="auth-l">
    <div class="fg"><label>Email / Phone</label><input id="li-id" autocomplete="username" onkeydown="if(event.key==='Enter')doLogin()"/></div>
    <div class="fg"><label>Password</label><input type="password" id="li-pw" autocomplete="current-password" onkeydown="if(event.key==='Enter')doLogin()"/></div>
    <button class="btn btn-ye btn-full" style="padding:13px;margin-top:4px;" onclick="doLogin()">Log In</button>
   </div>
   <div class="auth-body" id="auth-r" style="display:none;">
    <div class="fg"><label>Full Name *</label><input id="rg-name" autocomplete="name"/></div>
    <div class="fg"><label>Email *</label><input type="email" id="rg-email" autocomplete="email"/></div>
    <div class="fg"><label>Phone *</label><input type="tel" id="rg-phone" placeholder="+9647..." autocomplete="tel"/></div>
    <div class="fg"><label>Password * (min 8)</label><input type="password" id="rg-pw" autocomplete="new-password"/></div>
    <div class="fg">
     <label>Photo (optional)</label>
     <div style="display:flex;align-items:center;gap:11px;">
      <div id="rg-av" style="width:42px;height:42px;border-radius:50%;background:var(--bg3);border:1px solid var(--b1);display:flex;align-items:center;justify-content:center;font-size:1.2rem;overflow:hidden;flex-shrink:0;">üßë</div>
      <input type="file" id="rg-av-file" accept="image/*" style="display:none" onchange="prevAv(this,'rg-av')"/>
      <button class="btn btn-gh btn-sm" onclick="document.getElementById('rg-av-file').click()">Upload Photo</button>
     </div>
    </div>
    <button class="btn btn-ye btn-full" style="padding:13px;" onclick="doRegister()">Create Account</button>
   </div>
  </div>
 </div>
</div>

<!-- APP -->
<div id="app-screen">
 <div id="top-nav">
  <div class="nav-logo" onclick="goPage('trade')"><div class="dot"></div>NexCoinX</div>
  <div class="nav-tabs">
   <div class="nav-tab on" onclick="goPage('trade')">Trade</div>
   <div class="nav-tab" onclick="goPage('charts')">üìä Charts</div>
   <div class="nav-tab" onclick="goPage('dashboard')">Dashboard</div>
   <div class="nav-tab" onclick="goPage('assets')">Assets</div>
   <div class="nav-tab" onclick="goPage('messages')">Messages <span id="msg-nb" style="background:var(--re);color:#fff;font-size:.57rem;padding:1px 5px;border-radius:99px;display:none;vertical-align:middle;"></span></div>
   <div class="nav-tab" onclick="goPage('alerts')">üîî Alerts</div>
   <div class="nav-tab" onclick="goPage('profile')">Profile</div>
   <div class="nav-tab" onclick="goPage('settings')">Settings</div>
  </div>
  <div class="nav-right">
   <div class="bal-chip" onclick="openDep()"><span class="lbl">Balance</span><span class="amt" id="nav-bal">$0.00</span></div>
   <div class="icon-btn" onclick="goPage('messages')">
    <svg width="14" height="14" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"/><path d="M13.73 21a2 2 0 0 1-3.46 0"/></svg>
    <div class="ndot" id="ndot"></div>
   </div>
   <button class="btn btn-ye btn-sm" onclick="openDep()">Deposit</button>
   <button class="btn btn-gh btn-sm" onclick="doLogout()">Logout</button>
  </div>
 </div>
 <div class="ticker-wrap" id="ticker-wrap" style="display:none;"></div>
 <div class="app-wrap">
  <div class="app-inner">
   <aside class="sidebar">
    <div class="sbg">
     <div class="sbl">Trading</div>
     <div class="sbk on" id="sb-trade" onclick="goPage('trade')"><svg fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M3 3v18h18"/><path d="m19 9-5 5-4-4-3 3"/></svg>Trade</div>
     <div class="sbk" id="sb-charts" onclick="goPage('charts')"><svg fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><rect x="3" y="3" width="18" height="18" rx="2"/><path d="m8 16 3-4 3 3 3-5"/></svg>Charts</div>
     <div class="sbk" id="sb-dashboard" onclick="goPage('dashboard')"><svg fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><rect x="3" y="3" width="7" height="7"/><rect x="14" y="3" width="7" height="7"/><rect x="14" y="14" width="7" height="7"/><rect x="3" y="14" width="7" height="7"/></svg>Dashboard</div>
     <div class="sbk" id="sb-assets" onclick="goPage('assets')"><svg fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><rect x="2" y="7" width="20" height="14" rx="2"/><path d="M16 7V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v2"/></svg>Assets</div>
    </div>
    <div class="sbg">
     <div class="sbl">Account</div>
     <div class="sbk" id="sb-messages" onclick="goPage('messages')"><svg fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/></svg>Messages<span class="sb-badge" id="sb-mbadge" style="display:none;"></span></div>
     <div class="sbk" id="sb-alerts" onclick="goPage('alerts')"><svg fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"/><path d="M13.73 21a2 2 0 0 1-3.46 0"/></svg>Price Alerts</div>
     <div class="sbk" id="sb-profile" onclick="goPage('profile')"><svg fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><circle cx="12" cy="8" r="4"/><path d="M4 20c0-4 3.6-7 8-7s8 3 8 7"/></svg>Profile</div>
     <div class="sbk" id="sb-settings" onclick="goPage('settings')"><svg fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-4 0v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83-2.83l.06-.06A1.65 1.65 0 0 0 4.68 15a1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1 0-4h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 2.83-2.83l.06.06A1.65 1.65 0 0 0 9 4.68a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 4 0v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 2.83l-.06.06A1.65 1.65 0 0 0 19.4 9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 0 4h-.09a1.65 1.65 0 0 0-1.51 1z"/></svg>Settings</div>
     <div class="sbk" onclick="openDep()"><svg fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M12 2v20M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/></svg>Deposit</div>
     <div class="sbk" onclick="doLogout()"><svg fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/><polyline points="16 17 21 12 16 7"/><line x1="21" y1="12" x2="9" y2="12"/></svg>Logout</div>
    </div>
   </aside>
   <div class="app-main">
    <!-- TRADE -->
    <div class="pg on" id="pg-trade">
     <div class="mkt-hdr">
      <div id="mh-icon"></div>
      <div style="min-width:0;"><div style="font-weight:700;font-size:.9rem;" id="mh-name">Select a coin</div><div style="color:var(--t3);font-size:.7rem;" id="mh-sym"></div></div>
      <div style="margin-inline-start:8px;"><div style="font-family:var(--mn);font-size:1.25rem;font-weight:700;" id="mh-price">--</div><div style="font-size:.75rem;font-family:var(--mn);" id="mh-chg"></div></div>
      <div style="margin-inline-start:auto;display:flex;gap:6px;">
       <button class="btn btn-gh btn-sm" onclick="openCoinModal()" id="mobile-coin-btn" style="display:none;">üìã Coins</button>
      </div>
     </div>
     <div class="mkt-grid">
      <div class="coins-col" id="coins-col">
       <div class="cs-hdr"><div class="cs-srch"><svg width="11" height="11" fill="none" stroke="var(--t4)" stroke-width="2" viewBox="0 0 24 24"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.35-4.35"/></svg><input id="coin-srch" placeholder="Search..." oninput="renderCoinList()"/></div></div>
       <div id="coin-list-items"></div>
      </div>
      <div class="chart-col">
       <div class="chart-tb">
        <span class="clbl">Live Chart</span>
        <div style="margin-inline-start:auto;display:flex;gap:4px;">
         <button class="ct-btn on" id="ctype-line" onclick="setCType('line')">Line</button>
         <button class="ct-btn" id="ctype-candle" onclick="setCType('candle')">Candle</button>
        </div>
       </div>
       <div id="trade-wrap"><div id="trade-chart"></div></div>
      </div>
      <div class="order-col">
       <div class="ttype-row">
        <div class="ttb buy on" id="ttb-buy" onclick="setTT('buy')">Buy</div>
        <div class="ttb sell" id="ttb-sell" onclick="setTT('sell')">Sell</div>
       </div>
       <div class="order-body">
        <div style="font-size:.7rem;color:var(--t3);margin-bottom:8px;">Available: <span style="font-family:var(--mn);color:var(--tx);" id="avail">$0.00</span></div>
        <div class="tinw"><input type="number" id="ord-usd" inputmode="decimal" placeholder="Amount (USD)" oninput="updOrd()"/><span class="sfx">USD</span></div>
        <div style="display:flex;gap:5px;margin-bottom:10px;">
         <button class="btn btn-gh btn-xs" style="flex:1;" onclick="setAmt(10)">$10</button>
         <button class="btn btn-gh btn-xs" style="flex:1;" onclick="setAmt(25)">$25</button>
         <button class="btn btn-gh btn-xs" style="flex:1;" onclick="setAmt(50)">$50</button>
         <button class="btn btn-gh btn-xs" style="flex:1;" onclick="setAmt(100)">$100</button>
        </div>
        <div class="tir"><span class="k">Price</span><span class="v" id="ord-price">--</span></div>
        <div class="tir"><span class="k">You receive</span><span class="v" id="ord-coins">--</span></div>
        <div class="tir"><span class="k">Fee</span><span class="v" style="color:var(--t3);">0%</span></div>
        <button class="exec-btn buy" id="exec-btn" onclick="execOrd()">Buy</button>
       </div>
       <div class="side-hold" id="side-hold"></div>
      </div>
     </div>
    </div>
    <!-- CHARTS -->
    <div class="pg" id="pg-charts">
     <div class="charts-pg-hdr">
      <div><div style="font-size:.95rem;font-weight:800;">üìä All Coins ‚Äî Live Charts</div><div style="color:var(--t3);font-size:.72rem;margin-top:2px;">Auto-selects Candlestick or Line per coin</div></div>
      <button class="btn btn-gh btn-sm" onclick="renderChartsPage()">‚Üª Refresh</button>
     </div>
     <div class="charts-grid" id="charts-grid"></div>
    </div>
    <!-- DASHBOARD -->
    <div class="pg" id="pg-dashboard">
     <div class="pi">
      <div style="font-size:.95rem;font-weight:800;margin-bottom:14px;">Overview</div>
      <div class="stats-grid" id="stats-g"></div>
      <div class="sec-box"><div class="sec-hdr"><div class="sec-ttl">Recent Transactions</div></div><div style="overflow-x:auto;"><table><thead><tr><th>Coin</th><th>Type</th><th>Amount</th><th>USD</th><th>Date</th></tr></thead><tbody id="db-tx"></tbody></table></div></div>
      <div class="sec-box"><div class="sec-hdr"><div class="sec-ttl">Deposit History</div><button class="btn btn-ye btn-sm" onclick="openDep()">+ Deposit</button></div><div style="overflow-x:auto;"><table><thead><tr><th>Method</th><th>Amount</th><th>Status</th><th>Date</th><th>Receipt</th></tr></thead><tbody id="db-dep"></tbody></table></div></div>
     </div>
    </div>
    <!-- ASSETS -->
    <div class="pg" id="pg-assets">
     <div class="pi">
      <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:14px;"><div style="font-size:.95rem;font-weight:800;">My Assets</div><div style="font-family:var(--mn);font-weight:700;">Total: <span id="tot-val" style="color:var(--ye);">$0.00</span></div></div>
      <div class="sec-box"><div class="sec-hdr"><div class="sec-ttl">Holdings</div></div><div style="overflow-x:auto;"><table><thead><tr><th>Coin</th><th>Balance</th><th>Price</th><th>Value</th><th></th></tr></thead><tbody id="assets-body"></tbody></table></div></div>
     </div>
    </div>
    <!-- MESSAGES -->
    <div class="pg" id="pg-messages">
     <div class="msg-layout">
      <div class="msg-list" id="msg-list-col">
       <div class="ml-hdr">Messages</div>
       <div id="msg-list-items"><div style="padding:18px;color:var(--t4);font-size:.8rem;text-align:center;">No messages yet</div></div>
      </div>
      <div class="msg-chat" id="msg-chat">
       <div class="no-chat"><div style="font-size:2rem;">üí¨</div><div style="color:var(--t4);">No messages yet<br><span style="font-size:.77rem;">Admin will contact you here</span></div></div>
      </div>
     </div>
    </div>
    <!-- ALERTS -->
    <div class="pg" id="pg-alerts">
     <div class="pi">
      <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:16px;"><div style="font-size:.95rem;font-weight:800;">üîî Price Alerts</div><button class="btn btn-ye btn-sm" onclick="openAlertModal()">+ New Alert</button></div>
      <div id="alerts-list"><div style="text-align:center;padding:40px 20px;color:var(--t4);font-size:.82rem;">No alerts set.<br>Create one to get notified when a coin hits your target.</div></div>
     </div>
    </div>
    <!-- PROFILE -->
    <div class="pg" id="pg-profile">
     <div class="pi">
      <div style="font-size:.95rem;font-weight:800;margin-bottom:14px;">My Profile</div>
      <div class="prof-grid">
       <div class="prof-card" id="prof-card"></div>
       <div><div class="sec-box"><div class="sec-hdr"><div class="sec-ttl">Change Password</div></div><div style="padding:15px;"><div class="fg"><label>New Password</label><input type="password" id="np1" autocomplete="new-password"/></div><div class="fg"><label>Confirm Password</label><input type="password" id="np2" autocomplete="new-password"/></div><button class="btn btn-ye" onclick="changePw()">Update Password</button></div></div></div>
      </div>
     </div>
    </div>
    <!-- SETTINGS -->
    <div class="pg" id="pg-settings">
     <div class="pi">
      <div style="font-size:.95rem;font-weight:800;margin-bottom:16px;">Settings</div>
      <div class="settings-grid">
       <div class="setting-card"><h4>Language / ÿ≤ŸÖÿßŸÜ</h4><div class="lang-opts"><div class="lang-opt on" id="lang-en" onclick="setLang('en')"><div class="lf">üá¨üáß</div><div class="ln">English</div><div class="lk">English</div></div><div class="lang-opt" id="lang-ku" onclick="setLang('ku')"><div class="lf">üáÆüá∂</div><div class="ln">Kurdish</div><div class="lk">⁄©Ÿàÿ±ÿØ€å ÿ≥Ÿàÿ±ÿßŸÜ€å</div></div></div></div>
       <div class="setting-card"><h4>Notifications</h4><div style="display:flex;flex-direction:column;gap:12px;"><div style="display:flex;justify-content:space-between;align-items:center;"><span>Message alerts</span><div class="sw on" onclick="this.classList.toggle('on')"></div></div><div style="display:flex;justify-content:space-between;align-items:center;"><span>Deposit alerts</span><div class="sw on" onclick="this.classList.toggle('on')"></div></div><div style="display:flex;justify-content:space-between;align-items:center;"><span>Price alerts</span><div class="sw on" onclick="this.classList.toggle('on')"></div></div></div></div>
      </div>
      <div class="setting-card" style="margin-top:14px;"><h4>About NexCoinX</h4><div style="color:var(--t3);font-size:.81rem;line-height:1.7;margin-top:8px;">NexCoinX is a professional crypto exchange. All deposits are manually verified by our team for your safety.</div></div>
     </div>
    </div>
   </div>
  </div>
 </div>
 <!-- BOTTOM NAV -->
 <div id="bottom-nav">
  <div class="bn-inner">
   <div class="bn-item on" onclick="goPage('trade')"><svg fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M3 3v18h18"/><path d="m19 9-5 5-4-4-3 3"/></svg><span>Trade</span></div>
   <div class="bn-item" onclick="goPage('charts')"><svg fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><rect x="3" y="3" width="18" height="18" rx="2"/><path d="m8 16 3-4 3 3 3-5"/></svg><span>Charts</span></div>
   <div class="bn-item" style="position:relative;" onclick="openDep()">
    <div style="width:44px;height:44px;border-radius:50%;background:var(--ye);display:flex;align-items:center;justify-content:center;margin-top:-18px;box-shadow:0 4px 14px rgba(240,185,11,.4);"><svg width="18" height="18" fill="none" stroke="#000" stroke-width="2.5" viewBox="0 0 24 24"><path d="M12 2v20M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/></svg></div>
    <span style="margin-top:1px;">Deposit</span>
   </div>
   <div class="bn-item" onclick="goPage('messages')"><svg fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/></svg><div class="bn-dot" id="bn-dot"></div><span>Messages</span></div>
   <div class="bn-item" onclick="goPage('dashboard')"><svg fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><circle cx="12" cy="8" r="4"/><path d="M4 20c0-4 3.6-7 8-7s8 3 8 7"/></svg><span>Account</span></div>
  </div>
 </div>
</div>

<!-- MODALS -->
<div class="ovl" id="dep-ovl">
 <div class="modal"><div class="mdrag"></div>
  <div class="mhdr"><h3>Deposit Funds</h3><div class="mclose" onclick="closeDep()">‚úï</div></div>
  <div class="mbody">
   <div class="dep-steps"><div class="ds on" id="ds1"><div class="dsn">1</div><span>Method</span></div><div class="dsl"></div><div class="ds" id="ds2"><div class="dsn">2</div><span>Amount</span></div><div class="dsl"></div><div class="ds" id="ds3"><div class="dsn">3</div><span>Receipt</span></div><div class="dsl"></div><div class="ds" id="ds4"><div class="dsn">4</div><span>Submit</span></div></div>
   <div id="dep1"><div style="font-size:.81rem;color:var(--t2);margin-bottom:12px;">Choose payment method:</div><div class="pay-meths"><div class="pmeth" id="pm-fp" onclick="selPM('fastpay')"><div class="pm-nm" style="color:#FF6B00;">‚ö° Fast Pay</div><div class="pm-url">fast-pay.iq</div></div><div class="pmeth" id="pm-fib" onclick="selPM('fib')"><div class="pm-nm" style="color:#00A651;">üè¶ FIB</div><div class="pm-url">fib.iq</div></div><div class="pmeth disabled"><div class="pm-nm" style="color:var(--t3);">‚ñ™ OKX Pay</div><div class="pm-url">okx.com</div><div><span class="soon-badge">Soon</span></div></div></div><button class="btn btn-ye btn-full" onclick="depNext(2)">Next ‚Üí</button></div>
   <div id="dep2" style="display:none;"><div class="acct-box"><div class="abt">Send payment to this account</div><div class="acct-num">0750 113 3915</div><div style="color:var(--t3);font-size:.73rem;margin-top:4px;" id="dep-acct-sub"></div></div><div class="warn-box"><span>‚ö†Ô∏è</span><span>Send exact amount to <strong>0750 113 3915</strong>. Upload screenshot. Balance credited after admin approval only.</span></div><div class="fg"><label>Amount Sent (USD) *</label><input type="number" id="dep-amt" inputmode="decimal"/></div><div class="fg"><label>Your Phone *</label><input type="tel" id="dep-phone" placeholder="+9647..." autocomplete="tel"/></div><div style="display:flex;gap:8px;"><button class="btn btn-gh" style="flex:0 0 auto;" onclick="depNext(1)">‚Üê Back</button><button class="btn btn-ye" style="flex:1;" onclick="depNext(3)">Next ‚Üí</button></div></div>
   <div id="dep3" style="display:none;"><div style="font-size:.81rem;color:var(--t2);margin-bottom:12px;">Upload a clear screenshot of your payment receipt.</div><div class="upload-zone" id="uzn" onclick="document.getElementById('dep-doc').click()"><input type="file" id="dep-doc" accept="image/*,application/pdf" onchange="handleDoc(this)" style="display:none;"/><div id="uz-ic" style="font-size:1.8rem;margin-bottom:7px;">üìÑ</div><div id="uz-tx" style="color:var(--t3);font-size:.82rem;">Tap to upload receipt</div><div style="color:var(--t4);font-size:.68rem;margin-top:3px;">JPG, PNG, PDF ‚Äî max 10MB</div><div id="uz-fn" style="color:var(--gr);font-size:.8rem;font-weight:600;margin-top:5px;display:none;"></div></div><div style="display:flex;gap:8px;margin-top:12px;"><button class="btn btn-gh" style="flex:0 0 auto;" onclick="depNext(2)">‚Üê Back</button><button class="btn btn-ye" style="flex:1;" onclick="depNext(4)">Next ‚Üí</button></div></div>
   <div id="dep4" style="display:none;"><div style="background:var(--bg3);border:1px solid var(--b1);border-radius:var(--r);padding:14px;margin-bottom:13px;"><div style="font-weight:700;margin-bottom:10px;font-size:.87rem;">Review Your Deposit</div><div class="sum-row"><span class="sk">Method</span><span id="sum-meth" style="font-weight:600;"></span></div><div class="sum-row"><span class="sk">Amount</span><span id="sum-amt" style="font-family:var(--mn);font-weight:700;color:var(--ye);"></span></div><div class="sum-row"><span class="sk">Account</span><span style="font-family:var(--mn);">0750 113 3915</span></div><div class="sum-row"><span class="sk">Receipt</span><span id="sum-doc" style="color:var(--gr);font-size:.75rem;"></span></div></div><div class="warn-box"><span>üïê</span><span>Your request will be reviewed. Funds credited after admin confirmation.</span></div><div style="display:flex;gap:8px;"><button class="btn btn-gh" style="flex:0 0 auto;" onclick="depNext(3)">‚Üê Back</button><button class="btn btn-ye" style="flex:1;" onclick="submitDep()">‚úì Submit Request</button></div></div>
  </div>
 </div>
</div>
<div class="ovl" id="coin-modal-ovl">
 <div class="modal"><div class="mdrag"></div>
  <div class="mhdr"><h3>Select Coin</h3><div class="mclose" onclick="document.getElementById('coin-modal-ovl').classList.remove('show')">‚úï</div></div>
  <div class="mbody" style="padding:0;">
   <div class="cs-hdr" style="padding:10px 13px;border-bottom:1px solid var(--b1);"><div class="cs-srch"><svg width="11" height="11" fill="none" stroke="var(--t4)" stroke-width="2" viewBox="0 0 24 24"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.35-4.35"/></svg><input id="coin-srch2" placeholder="Search coins..." oninput="renderCoinList2()"/></div></div>
   <div id="coin-list-items2" style="max-height:60dvh;overflow-y:auto;"></div>
  </div>
 </div>
</div>
<div class="ovl" id="alert-ovl">
 <div class="modal"><div class="mdrag"></div>
  <div class="mhdr"><h3>üîî New Price Alert</h3><div class="mclose" onclick="document.getElementById('alert-ovl').classList.remove('show')">‚úï</div></div>
  <div class="mbody">
   <div class="fg"><label>Coin</label><select id="alert-coin"></select></div>
   <div class="fg"><label>Direction</label><select id="alert-dir"><option value="above">Price goes ABOVE target</option><option value="below">Price goes BELOW target</option></select></div>
   <div class="fg"><label>Target Price (USD)</label><input type="number" id="alert-price" inputmode="decimal" placeholder="0.0000" step="0.0001"/></div>
   <div style="background:var(--bg3);border-radius:var(--r);padding:10px 12px;margin-bottom:13px;font-size:.77rem;color:var(--t3);">You will be notified when the coin reaches your target price.</div>
   <button class="btn btn-ye btn-full" onclick="saveAlert()">Create Alert</button>
  </div>
 </div>
</div>
<div class="toast" id="toast"><span id="tic">‚úÖ</span> <span id="tmsg"></span></div>

<script>
const DB={
  get(){return JSON.parse(localStorage.getItem("ncx_db")||"null")||DB.def();},
  save(d){localStorage.setItem("ncx_db",JSON.stringify(d));},
  def(){return{coins:[{id:"btcx",name:"BitcoinX",symbol:"BTCX",price:.08,supply:21000000,color:"#f0b90b",icon:"\u20BF",candles:[]},{id:"ethx",name:"EtherX",symbol:"ETHX",price:.05,supply:10000000,color:"#818cf8",icon:"\u2B21",candles:[]},{id:"slrx",name:"SolarX",symbol:"SLRX",price:.032,supply:50000000,color:"#0ecb81",icon:"\u2600",candles:[]}],users:[],deposits:[],transactions:[],messages:[]};},
  getUsers(){return JSON.parse(localStorage.getItem("ncx_users")||"[]");},
  saveUsers(u){localStorage.setItem("ncx_users",JSON.stringify(u));},
  getUser(id){return DB.getUsers().find(u=>u.id===id)||null;},
  saveUser(u){const us=DB.getUsers();const i=us.findIndex(x=>x.id===u.id);if(i>=0)us[i]=u;else us.push(u);DB.saveUsers(us);}
};
function ensureC(c){if(c.candles&&c.candles.length>4)return;const now=Math.floor(Date.now()/1000);c.candles=[];let p=c.price;for(let i=0;i<24;i++){const t=now-(24-i)*1800;const o=p;const cl=parseFloat((p*(0.92+Math.random()*.16)).toFixed(6));const h=Math.max(o,cl)*(1+Math.random()*.012);const l=Math.min(o,cl)*(1-Math.random()*.012);c.candles.push({time:t,open:parseFloat(o.toFixed(6)),high:parseFloat(h.toFixed(6)),low:parseFloat(l.toFixed(6)),close:parseFloat(cl.toFixed(6)),value:parseFloat(cl.toFixed(6))});p=cl;}c.candles[c.candles.length-1].close=c.price;c.candles[c.candles.length-1].value=c.price;}
let CU=null,AC=null,TT="buy",LWC=null,LWS=null,depM=null,depDoc=null,depDocN=null,poll=null,chartType="line";
const _CC={};
let LANG=localStorage.getItem("ncx_lang")||"en";
let priceAlerts=JSON.parse(localStorage.getItem("ncx_alerts")||"[]");
function gv(id){return(document.getElementById(id)||{value:""}).value;}
function toast(icon,msg){document.getElementById("tic").textContent=icon;document.getElementById("tmsg").textContent=msg;const el=document.getElementById("toast");el.classList.add("show");clearTimeout(window._tt);window._tt=setTimeout(()=>el.classList.remove("show"),3500);}
function setLang(l){LANG=l;localStorage.setItem("ncx_lang",l);document.getElementById("lang-en").classList.toggle("on",l==="en");document.getElementById("lang-ku").classList.toggle("on",l==="ku");document.documentElement.lang=l;document.documentElement.dir=l==="ku"?"rtl":"ltr";document.body.classList.toggle("ku",l==="ku");}
function switchAuth(t){document.getElementById("auth-l").style.display=t==="l"?"block":"none";document.getElementById("auth-r").style.display=t==="r"?"block":"none";document.getElementById("atb-l").classList.toggle("on",t==="l");document.getElementById("atb-r").classList.toggle("on",t==="r");}
function prevAv(inp,tid){const f=inp.files[0];if(!f)return;const r=new FileReader();r.onload=e=>{const el=document.getElementById(tid);el.innerHTML=`<img src="${e.target.result}" style="width:100%;height:100%;object-fit:cover;border-radius:50%;"/>`;el.dataset.src=e.target.result;};r.readAsDataURL(f);}
function doLogin(){const id=gv("li-id").trim(),pw=gv("li-pw");if(!id||!pw)return toast("\u26a0\ufe0f","Enter email/phone and password");const u=DB.getUsers().find(u=>(u.email===id||u.phone===id)&&u.pw===pw);if(!u)return toast("\u274c","Invalid credentials");CU=u;localStorage.setItem("ncx_cu",JSON.stringify(u));toast("\u2705","Welcome back, "+u.name);setTimeout(enterApp,350);}
function doRegister(){const name=gv("rg-name").trim(),email=gv("rg-email").trim(),phone=gv("rg-phone").trim(),pw=gv("rg-pw"),avatar=document.getElementById("rg-av").dataset.src||"";if(!name||!email||!phone||!pw||pw.length<8)return toast("\u26a0\ufe0f","Fill all fields (password min 8 chars)");const us=DB.getUsers();if(us.find(u=>u.email===email)||us.find(u=>u.phone===phone))return toast("\u26a0\ufe0f","Already registered");const u={id:"u_"+Date.now(),name,email,phone,pw,avatar,balance:0,holdings:{},joined:new Date().toISOString()};DB.saveUser(u);const db=DB.get();db.users.push({id:u.id,name,email,phone,balance:0,joined:u.joined});DB.save(db);CU=u;localStorage.setItem("ncx_cu",JSON.stringify(u));toast("\u2705","Account created!");setTimeout(enterApp,350);}
function doLogout(){CU=null;localStorage.removeItem("ncx_cu");if(poll)clearInterval(poll);document.getElementById("app-screen").style.display="none";document.getElementById("top-nav").style.display="none";document.getElementById("auth-screen").style.display="flex";}
function enterApp(){document.getElementById("auth-screen").style.display="none";document.getElementById("app-screen").style.display="block";document.getElementById("top-nav").style.display="flex";const tw=document.getElementById("ticker-wrap");if(tw)tw.style.display="";refreshCU();setLang(LANG);goPage("trade");if(poll)clearInterval(poll);poll=setInterval(pollUp,2500);buildTicker();checkMobileMode();}
function checkMobileMode(){const mob=window.innerWidth<768;const mb=document.getElementById("mobile-coin-btn");if(mb)mb.style.display=mob?"":"none";}
window.addEventListener("resize",checkMobileMode);
function refreshCU(){const f=DB.getUser(CU.id);if(f){CU=f;localStorage.setItem("ncx_cu",JSON.stringify(CU));}}
function updBal(){const e=document.getElementById("nav-bal");if(e)e.textContent="$"+CU.balance.toFixed(2);const a=document.getElementById("avail");if(a)a.textContent="$"+CU.balance.toFixed(2);}
function pollUp(){refreshCU();updBal();if(AC){const db=DB.get();const fr=db.coins.find(c=>c.id===AC.id);if(fr&&(fr.price!==AC.price||fr.candles.length!==AC.candles.length)){AC=fr;updChartData();updMH();renderCoinList();}}chkMsgs();chkAlerts();buildTicker();}
function chkMsgs(){const db=DB.get();const n=(db.messages||[]).filter(m=>m.toUserId===CU.id&&!m.readByUser).length;["ndot","bn-dot"].forEach(id=>{const el=document.getElementById(id);if(el)el.classList.toggle("on",n>0);});const sb=document.getElementById("sb-mbadge");if(sb){sb.textContent=n;sb.style.display=n>0?"":"";}const nb=document.getElementById("msg-nb");if(nb){nb.textContent=n;nb.style.display=n>0?"":"none";}}
function buildTicker(){const db=DB.get();if(!db.coins.length)return;const wrap=document.getElementById("ticker-wrap");if(!wrap)return;const items=db.coins.map(c=>{const pts=c.candles.slice(-2).map(x=>x.value||x.close||c.price);const chg=pts.length>1?(pts[1]-pts[0])/pts[0]*100:0;return`<div class="ti"><span style="color:var(--t2);font-weight:600;">${c.symbol}</span><span>$${c.price.toFixed(4)}</span><span class="${chg>=0?"ti-up":"ti-dn"}">${chg>=0?"+":""}${chg.toFixed(2)}%</span></div>`;}).join("");wrap.innerHTML=`<div class="ticker-inner">${items}${items}${items}</div>`;}
function goPage(p){document.querySelectorAll(".pg").forEach(e=>e.classList.remove("on"));document.querySelectorAll(".sbk").forEach(e=>e.classList.remove("on"));document.querySelectorAll(".nav-tab").forEach(e=>e.classList.remove("on"));document.querySelectorAll(".bn-item").forEach(e=>e.classList.remove("on"));const pg=document.getElementById("pg-"+p);if(pg)pg.classList.add("on");const sb=document.getElementById("sb-"+p);if(sb)sb.classList.add("on");const tabs=[...document.querySelectorAll(".nav-tab")];const tmap={trade:0,charts:1,dashboard:2,assets:3,messages:4,alerts:5,profile:6,settings:7};if(tmap[p]!==undefined&&tabs[tmap[p]])tabs[tmap[p]].classList.add("on");const bns=[...document.querySelectorAll(".bn-item")];const bmap={trade:0,charts:1,messages:3,dashboard:4,assets:4,profile:4,alerts:4,settings:4};if(bmap[p]!==undefined&&bns[bmap[p]])bns[bmap[p]].classList.add("on");refreshCU();updBal();if(p==="trade"){renderCoinList();if(AC){updMH();setTimeout(()=>buildChart(),80);}}if(p==="charts")setTimeout(()=>renderChartsPage(),80);if(p==="dashboard")renderDB();if(p==="assets")renderAssets();if(p==="messages"){renderMsgs();if(window.innerWidth<768)document.getElementById("msg-list-col").classList.add("show");}if(p==="alerts")renderAlerts();if(p==="profile")renderProfile();}
function renderCoinList(){const db=DB.get();const q=(gv("coin-srch")||"").toLowerCase();const coins=db.coins.filter(c=>!q||c.name.toLowerCase().includes(q)||c.symbol.toLowerCase().includes(q));const el=document.getElementById("coin-list-items");if(!el)return;el.innerHTML=coins.map(c=>cliHtml(c)).join("");}
function renderCoinList2(){const db=DB.get();const q=(gv("coin-srch2")||"").toLowerCase();const coins=db.coins.filter(c=>!q||c.name.toLowerCase().includes(q)||c.symbol.toLowerCase().includes(q));const el=document.getElementById("coin-list-items2");if(!el)return;el.innerHTML=coins.map(c=>cliHtml(c,true)).join("");}
function cliHtml(c,modal=false){const pts=c.candles.slice(-4).map(x=>x.value||x.close||c.price);const chg=pts.length>1?(pts[pts.length-1]-pts[0])/pts[0]*100:0;const fn=modal?`selCoinModal("${c.id}")`:`selCoin("${c.id}")`;return`<div class="cli ${AC&&AC.id===c.id?"on":""}" onclick="${fn}"><div style="width:23px;height:23px;border-radius:50%;background:${c.color}20;display:flex;align-items:center;justify-content:center;font-size:.78rem;flex-shrink:0;">${c.icon}</div><div style="flex:1;margin-inline-start:7px;min-width:0;"><div style="font-weight:700;font-size:.77rem;">${c.symbol}</div><div style="color:var(--t3);font-size:.64rem;">${c.name}</div></div><div style="text-align:end;"><div style="font-family:var(--mn);font-size:.74rem;">$${c.price.toFixed(4)}</div><div style="font-family:var(--mn);font-size:.62rem;color:${chg>=0?"var(--gr)":"var(--re)"};">${chg>=0?"+":""}${chg.toFixed(2)}%</div></div></div>`;}
function openCoinModal(){renderCoinList2();document.getElementById("coin-modal-ovl").classList.add("show");}
function selCoin(id){const db=DB.get();const c=db.coins.find(x=>x.id===id);if(!c)return;ensureC(c);AC=c;updMH();buildChart();updOrd();renderCoinList();renderSideHold();}
function selCoinModal(id){document.getElementById("coin-modal-ovl").classList.remove("show");selCoin(id);}
function updMH(){if(!AC)return;const pts=AC.candles.slice(-8).map(x=>x.value||x.close||AC.price);const chg=pts.length>1?(pts[pts.length-1]-pts[0])/pts[0]*100:0;document.getElementById("mh-icon").innerHTML=`<div style="width:30px;height:30px;border-radius:50%;background:${AC.color}18;display:flex;align-items:center;justify-content:center;font-size:.88rem;flex-shrink:0;">${AC.icon}</div>`;document.getElementById("mh-name").textContent=AC.name;document.getElementById("mh-sym").textContent=AC.symbol+"/USD";const pr=document.getElementById("mh-price");pr.textContent="$"+AC.price.toFixed(4);pr.style.color=chg>=0?"var(--gr)":"var(--re)";const ch=document.getElementById("mh-chg");ch.textContent=(chg>=0?"+":"")+chg.toFixed(2)+"%";ch.style.color=chg>=0?"var(--gr)":"var(--re)";}
function hasOHLC(c){return c.candles&&c.candles.length>1&&c.candles[0].open!==undefined;}
function getLineData(c){const s=c.candles.slice().sort((a,b)=>a.time-b.time);const seen=new Set(),d=[];s.forEach(x=>{if(!seen.has(x.time)){seen.add(x.time);d.push({time:x.time,value:parseFloat((x.value||x.close||c.price).toFixed(6))});}});return d;}
function getOHLCData(c){const s=c.candles.slice().sort((a,b)=>a.time-b.time);const seen=new Set(),d=[];s.forEach(x=>{if(!seen.has(x.time)){seen.add(x.time);d.push({time:x.time,open:x.open||x.value||c.price,high:x.high||x.value||c.price,low:x.low||x.value||c.price,close:x.close||x.value||c.price});}});return d;}
function drawFallback(el,coin){const W=el.clientWidth||350,H=el.clientHeight||185;const cvs=document.createElement("canvas");cvs.style.cssText="width:100%;height:100%;display:block;";cvs.width=W;cvs.height=H;el.innerHTML="";el.appendChild(cvs);const ctx=cvs.getContext("2d");ctx.fillStyle="#0a0e17";ctx.fillRect(0,0,W,H);if(!coin||!coin.candles||coin.candles.length<2){ctx.fillStyle="#3d4d5e";ctx.font="11px sans-serif";ctx.textAlign="center";ctx.fillText("Chart loading...",W/2,H/2);return;}const pts=coin.candles.slice(-40).sort((a,b)=>a.time-b.time).map(x=>x.value||x.close||coin.price);const mn=Math.min(...pts)*.997,mx=Math.max(...pts)*1.003,range=mx-mn||.001;const pl=52,pr=6,pt=10,pb=22,cw=W-pl-pr,ch=H-pt-pb;ctx.strokeStyle="rgba(255,255,255,.03)";ctx.lineWidth=1;for(let i=0;i<=3;i++){const y=pt+ch*i/3;ctx.beginPath();ctx.moveTo(pl,y);ctx.lineTo(W-pr,y);ctx.stroke();ctx.fillStyle="#707a8a";ctx.font="9px monospace";ctx.textAlign="right";ctx.fillText("$"+(mx-range*i/3).toFixed(4),pl-3,y+3);}const color=coin.color||"#f0b90b";ctx.beginPath();ctx.strokeStyle=color;ctx.lineWidth=2;ctx.lineJoin="round";pts.forEach((v,i)=>{const x=pl+cw*i/(pts.length-1);const y=pt+ch*(1-(v-mn)/range);i===0?ctx.moveTo(x,y):ctx.lineTo(x,y);});ctx.stroke();const grd=ctx.createLinearGradient(0,pt,0,H-pb);grd.addColorStop(0,color+"33");grd.addColorStop(1,color+"00");ctx.beginPath();pts.forEach((v,i)=>{const x=pl+cw*i/(pts.length-1);const y=pt+ch*(1-(v-mn)/range);i===0?ctx.moveTo(x,y):ctx.lineTo(x,y);});ctx.lineTo(pl+cw,H-pb);ctx.lineTo(pl,H-pb);ctx.closePath();ctx.fillStyle=grd;ctx.fill();}
function buildChart(){const wrap=document.getElementById("trade-wrap");const c=document.getElementById("trade-chart");if(!c||!wrap)return;c.innerHTML="";if(LWC){try{LWC.remove();}catch(e){}}LWC=null;if(!AC){drawFallback(c,null);return;}const W=wrap.clientWidth||600,H=wrap.clientHeight||380;if(typeof LightweightCharts==="undefined"){drawFallback(c,AC);return;}const ch=LightweightCharts.createChart(c,{width:W,height:H,layout:{background:{color:"#0a0e17"},textColor:"#707a8a"},grid:{vertLines:{color:"rgba(255,255,255,.025)"},horzLines:{color:"rgba(255,255,255,.025)"}},crosshair:{mode:LightweightCharts.CrosshairMode.Normal},rightPriceScale:{borderColor:"rgba(255,255,255,.05)",scaleMargins:{top:.08,bottom:.08}},timeScale:{borderColor:"rgba(255,255,255,.05)",timeVisible:true}});LWC=ch;const useCandle=chartType==="candle"&&hasOHLC(AC);if(useCandle){LWS=ch.addCandlestickSeries({upColor:"#0ecb81",downColor:"#f6465d",borderUpColor:"#0ecb81",borderDownColor:"#f6465d",wickUpColor:"#0ecb81",wickDownColor:"#f6465d"});const d=getOHLCData(AC);if(d.length)LWS.setData(d);}else{LWS=ch.addLineSeries({color:AC.color||"#f0b90b",lineWidth:2,crosshairMarkerVisible:true,lastValueVisible:true,priceLineVisible:true});const d=getLineData(AC);if(d.length)LWS.setData(d);}ch.timeScale().fitContent();const ro=new ResizeObserver(()=>{if(LWC&&wrap)LWC.resize(wrap.clientWidth||600,wrap.clientHeight||380);});ro.observe(wrap);}
function updChartData(){if(!LWS||!LWC||!AC)return;const useCandle=chartType==="candle"&&hasOHLC(AC);if(useCandle){const d=getOHLCData(AC);if(d.length)LWS.setData(d);}else{const d=getLineData(AC);if(d.length)LWS.setData(d);}LWC.timeScale().fitContent();}
function setCType(t){chartType=t;document.getElementById("ctype-line").classList.toggle("on",t==="line");document.getElementById("ctype-candle").classList.toggle("on",t==="candle");if(AC)buildChart();}
function renderSideHold(){const db=DB.get();const el=document.getElementById("side-hold");if(!el)return;const h=CU.holdings||{};const ent=Object.entries(h).filter(([,a])=>a>.0001);if(!ent.length){el.innerHTML=`<div style="color:var(--t4);font-size:.73rem;text-align:center;padding:8px;">No holdings yet</div>`;return;}el.innerHTML=`<div style="font-size:.66rem;color:var(--t3);text-transform:uppercase;letter-spacing:.05em;margin-bottom:7px;">Holdings</div>`+ent.map(([cid,amt])=>{const c=db.coins.find(x=>x.id===cid);if(!c)return"";return`<div style="display:flex;justify-content:space-between;padding:6px 0;border-bottom:1px solid rgba(255,255,255,.02);font-size:.75rem;"><div style="display:flex;align-items:center;gap:5px;">${c.icon}<span style="font-weight:700;">${c.symbol}</span></div><div style="text-align:end;"><div style="font-family:var(--mn);">${amt.toFixed(4)}</div><div style="color:var(--t3);font-size:.65rem;">$${(amt*c.price).toFixed(2)}</div></div></div>`;}).join("");}
window._lwcReady=function(){if(AC)buildChart();const cp=document.getElementById("pg-charts");if(cp&&cp.classList.contains("on"))renderChartsPage();};
function renderChartsPage(){const db=DB.get();const grid=document.getElementById("charts-grid");if(!grid)return;Object.values(_CC).forEach(ch=>{try{ch.remove();}catch(e){}});Object.keys(_CC).forEach(k=>delete _CC[k]);if(!db.coins||!db.coins.length){grid.innerHTML=`<div style="padding:40px;text-align:center;color:var(--t4);">No coins available</div>`;return;}db.coins.forEach(c=>ensureC(c));DB.save(db);grid.innerHTML=db.coins.map(c=>{const pts=c.candles.slice(-8).map(x=>x.value||x.close||c.price);const chg=pts.length>1?(pts[pts.length-1]-pts[0])/pts[0]*100:0;const uc=hasOHLC(c);return`<div class="chart-card"><div class="chart-card-hdr"><div class="cc-ico" style="background:${c.color}18;">${c.icon}</div><div style="flex:1;min-width:0;"><div style="font-weight:700;font-size:.84rem;">${c.name}<span class="chart-type-badge ${uc?"ct-candle":"ct-line"}">${uc?"CANDLE":"LINE"}</span></div><div style="color:var(--t3);font-size:.69rem;">${c.symbol}/USD</div></div><div style="text-align:end;"><div style="font-family:var(--mn);font-weight:700;font-size:.9rem;color:${chg>=0?"var(--gr)":"var(--re)"};">$${c.price.toFixed(4)}</div><div style="font-family:var(--mn);font-size:.7rem;color:${chg>=0?"var(--gr)":"var(--re)"};">${chg>=0?"+":""}${chg.toFixed(2)}%</div></div></div><div class="chart-card-chart"><div id="cc-${c.id}"></div></div><div class="chart-card-foot"><span style="color:var(--t3);font-size:.68rem;">${(c.supply||0).toLocaleString()} supply</span><button class="btn btn-ye btn-xs" onclick="selCoin('${c.id}');goPage('trade');">Trade</button></div></div>`;}).join("");requestAnimationFrame(()=>{db.coins.forEach(c=>{const el=document.getElementById("cc-"+c.id);if(!el)return;const par=el.parentElement;const W=par.clientWidth||360,H=185;if(typeof LightweightCharts==="undefined"){drawFallback(el,c);return;}const ch=LightweightCharts.createChart(el,{width:W,height:H,layout:{background:{color:"#0d1220"},textColor:"#707a8a"},grid:{vertLines:{color:"rgba(255,255,255,.02)"},horzLines:{color:"rgba(255,255,255,.02)"}},crosshair:{mode:LightweightCharts.CrosshairMode.Normal},rightPriceScale:{borderColor:"rgba(255,255,255,.04)",scaleMargins:{top:.1,bottom:.1}},timeScale:{borderColor:"rgba(255,255,255,.04)",timeVisible:true},handleScroll:false,handleScale:false});_CC[c.id]=ch;if(hasOHLC(c)){const s=ch.addCandlestickSeries({upColor:"#0ecb81",downColor:"#f6465d",borderUpColor:"#0ecb81",borderDownColor:"#f6465d",wickUpColor:"#0ecb81",wickDownColor:"#f6465d"});const d=getOHLCData(c);if(d.length)s.setData(d);}else{const s=ch.addLineSeries({color:c.color||"#f0b90b",lineWidth:2,lastValueVisible:true,priceLineVisible:false});const d=getLineData(c);if(d.length)s.setData(d);}ch.timeScale().fitContent();const ro=new ResizeObserver(()=>{if(_CC[c.id])_CC[c.id].resize(par.clientWidth||360,H);});ro.observe(par);});});}
function setAmt(v){document.getElementById("ord-usd").value=v;updOrd();}
function updOrd(){const amt=parseFloat(gv("ord-usd"))||0;if(!AC)return;document.getElementById("ord-price").textContent="$"+AC.price.toFixed(4);document.getElementById("ord-coins").textContent=amt>0?(amt/AC.price).toFixed(4)+" "+AC.symbol:"--";}
function setTT(t){TT=t;document.getElementById("ttb-buy").className="ttb buy"+(t==="buy"?" on":"");document.getElementById("ttb-sell").className="ttb sell"+(t==="sell"?" on":"");const btn=document.getElementById("exec-btn");btn.className="exec-btn "+t;btn.textContent=t==="buy"?"Buy":"Sell";}
function execOrd(){const amt=parseFloat(gv("ord-usd"))||0;if(!amt||amt<=0)return toast("\u26a0\ufe0f","Enter an amount");if(!AC)return toast("\u26a0\ufe0f","Select a coin first");refreshCU();if(TT==="buy"){if(CU.balance<amt)return toast("\u274c","Insufficient balance");const coins=amt/AC.price;CU.balance=parseFloat((CU.balance-amt).toFixed(6));CU.holdings=CU.holdings||{};CU.holdings[AC.id]=parseFloat(((CU.holdings[AC.id]||0)+coins).toFixed(6));const db=DB.get();const ci=db.coins.findIndex(x=>x.id===AC.id);if(ci>=0){const c=db.coins[ci];const np=parseFloat((c.price*(1+.0012+Math.random()*.001)).toFixed(6));const now=Math.floor(Date.now()/1000);c.candles.push({time:now,open:c.price,high:np*1.001,low:c.price*.999,close:np,value:np});c.price=np;db.transactions.push({id:"tx_"+Date.now(),type:"buy",userId:CU.id,userName:CU.name,coinId:c.id,coinName:c.name,coinsAmt:coins,usdAmt:amt,price:np,date:new Date().toISOString()});DB.save(db);AC=db.coins[ci];}DB.saveUser(CU);updBal();toast("\u2705","Bought "+coins.toFixed(4)+" "+AC.symbol);}else{const held=(CU.holdings||{})[AC.id]||0;const toSell=amt/AC.price;if(held<toSell)return toast("\u274c","Not enough coins to sell");CU.balance=parseFloat((CU.balance+amt).toFixed(6));CU.holdings[AC.id]=parseFloat((held-toSell).toFixed(6));const db=DB.get();const ci=db.coins.findIndex(x=>x.id===AC.id);if(ci>=0){const c=db.coins[ci];const np=Math.max(.0001,parseFloat((c.price*(1-.0012-Math.random()*.001)).toFixed(6)));const now=Math.floor(Date.now()/1000);c.candles.push({time:now,open:c.price,high:c.price*1.001,low:np*.999,close:np,value:np});c.price=np;db.transactions.push({id:"tx_"+Date.now(),type:"sell",userId:CU.id,userName:CU.name,coinId:c.id,coinName:c.name,coinsAmt:toSell,usdAmt:amt,price:np,date:new Date().toISOString()});DB.save(db);AC=db.coins[ci];}DB.saveUser(CU);updBal();toast("\u2705","Sold for $"+amt.toFixed(2));}document.getElementById("ord-usd").value="";updOrd();renderSideHold();updChartData();updMH();}
function renderDB(){const db=DB.get();let pv=0;Object.entries(CU.holdings||{}).forEach(([cid,amt])=>{const c=db.coins.find(x=>x.id===cid);if(c)pv+=amt*c.price;});const myTx=(db.transactions||[]).filter(t=>t.userId===CU.id);const myDeps=(db.deposits||[]).filter(d=>d.userId===CU.id);const appDep=myDeps.filter(d=>d.status==="approved").reduce((s,d)=>s+d.amount,0);const sb=(l,v,c,s1,s2)=>`<div class="sbox"><div class="sl">${l}</div><div class="sv" style="color:${c};">${v}</div><div class="sh">${s1}${s2?`<br>${s2}`:""}</div></div>`;document.getElementById("stats-g").innerHTML=sb("Balance","$"+CU.balance.toFixed(2),"var(--ye)","Available funds","")+sb("Portfolio","$"+pv.toFixed(2),"var(--bl)",Object.keys(CU.holdings||{}).length+" coins held","")+sb("Deposited","$"+appDep.toFixed(0),"var(--gr)",myDeps.filter(d=>d.status==="approved").length+" approved","")+sb("Trades",myTx.length,"var(--pu)","Lifetime trades","");const txs=myTx.slice().reverse().slice(0,10);document.getElementById("db-tx").innerHTML=!txs.length?`<tr><td colspan="5" style="color:var(--t3);padding:14px;text-align:center;">No transactions yet</td></tr>`:txs.map(tx=>`<tr><td><strong>${tx.coinName}</strong></td><td><span class="badge ${tx.type==="buy"?"bg":"br"}">${tx.type.toUpperCase()}</span></td><td style="font-family:var(--mn);">${tx.coinsAmt.toFixed(4)}</td><td style="font-family:var(--mn);">$${tx.usdAmt.toFixed(2)}</td><td style="color:var(--t3);font-size:.7rem;">${new Date(tx.date).toLocaleString()}</td></tr>`).join("");const deps=myDeps.slice().reverse();document.getElementById("db-dep").innerHTML=!deps.length?`<tr><td colspan="5" style="color:var(--t3);padding:14px;text-align:center;">No deposits yet</td></tr>`:deps.map(d=>`<tr><td><span class="badge bb">${d.method==="fastpay"?"‚ö° Fast Pay":"üè¶ FIB"}</span></td><td style="font-family:var(--mn);color:var(--ye);">$${d.amount}</td><td><span class="badge ${d.status==="pending"?"bo":d.status==="approved"?"bg":"br"}">${d.status==="pending"?"‚è≥ Pending":d.status==="approved"?"‚úì Approved":"‚úó Rejected"}</span></td><td style="color:var(--t3);font-size:.7rem;">${new Date(d.date).toLocaleString()}</td><td>${d.docData?`<a href="${d.docData}" download="receipt" style="color:var(--bl);font-size:.73rem;text-decoration:none;">üìÑ View</a>`:"--"}</td></tr>`).join("");}
function renderAssets(){const db=DB.get();const h=CU.holdings||{};const ent=Object.entries(h).filter(([,a])=>a>.00001);let tot=0;ent.forEach(([cid,amt])=>{const c=db.coins.find(x=>x.id===cid);if(c)tot+=amt*c.price;});document.getElementById("tot-val").textContent="$"+tot.toFixed(2);document.getElementById("assets-body").innerHTML=!ent.length?`<tr><td colspan="5" style="color:var(--t3);padding:14px;text-align:center;">No assets yet</td></tr>`:ent.map(([cid,amt])=>{const c=db.coins.find(x=>x.id===cid);if(!c)return"";return`<tr><td><div style="display:flex;align-items:center;gap:7px;"><div style="width:24px;height:24px;border-radius:50%;background:${c.color}18;display:flex;align-items:center;justify-content:center;font-size:.82rem;">${c.icon}</div><div><div style="font-weight:700;">${c.name}</div><div style="color:var(--t3);font-size:.68rem;">${c.symbol}</div></div></div></td><td style="font-family:var(--mn);">${amt.toFixed(4)}</td><td style="font-family:var(--mn);">$${c.price.toFixed(4)}</td><td style="font-family:var(--mn);color:var(--ye);">$${(amt*c.price).toFixed(4)}</td><td><button class="btn btn-gh btn-xs" onclick="selCoin('${cid}');goPage('trade');">Trade</button></td></tr>`;}).join("");}
function renderMsgs(){const db=DB.get();const myMsgs=(db.messages||[]).filter(m=>m.toUserId===CU.id||m.fromUserId===CU.id);const el=document.getElementById("msg-list-items");const unread=myMsgs.filter(m=>m.toUserId===CU.id&&!m.readByUser).length;if(!myMsgs.length){el.innerHTML=`<div style="padding:18px;color:var(--t4);font-size:.8rem;text-align:center;">No messages yet</div>`;return;}const last=myMsgs.slice(-1)[0];el.innerHTML=`<div class="mli ${unread?"unread":""} on" onclick="openThread()"><div class="mli-av">A</div><div style="flex:1;min-width:0;"><div class="mli-nm">Admin${unread?` <span style="background:var(--re);color:#fff;font-size:.57rem;padding:1px 5px;border-radius:99px;">${unread}</span>`:""}</div><div class="mli-pv">${last.text.slice(0,40)}</div></div><div class="mli-tm">${tAgo(last.date)}</div></div>`;openThread();}
function openThread(){const db=DB.get();const msgs=(db.messages||[]).filter(m=>m.toUserId===CU.id||m.fromUserId===CU.id).sort((a,b)=>new Date(a.date)-new Date(b.date));msgs.forEach(m=>{if(m.toUserId===CU.id)m.readByUser=true;});DB.save(db);chkMsgs();const area=document.getElementById("msg-chat");area.innerHTML=`<div class="mc-hdr"><div class="mc-av">A</div><div><div class="mc-nm">Admin ‚Äî NexCoinX</div><div class="mc-st">&#x25CF; Online</div></div>${window.innerWidth<768?`<button class="btn btn-gh btn-xs" style="margin-inline-start:auto;" onclick="document.getElementById('msg-list-col').classList.add('show');document.getElementById('msg-chat').style.display=''">‚Üê Back</button>`:""}</div><div class="mc-body" id="mc-body">${msgs.length?msgs.map(m=>`<div><div class="bubble ${m.fromAdmin?"adm":"me"}">${escH(m.text)}</div><div class="btime">${new Date(m.date).toLocaleTimeString()}</div></div>`).join(""):`<div style="text-align:center;color:var(--t4);margin:auto;padding:20px;">No messages yet</div>`}</div><div class="mc-foot"><textarea id="mc-inp" placeholder="Type a message..." rows="1" onkeydown="if(event.key==='Enter'&&!event.shiftKey){event.preventDefault();sendMsg();}"></textarea><button class="btn btn-ye btn-sm" onclick="sendMsg()">Send</button></div>`;const b=document.getElementById("mc-body");if(b)b.scrollTop=b.scrollHeight;if(window.innerWidth<768){document.getElementById("msg-list-col").classList.remove("show");}}
function sendMsg(){const inp=document.getElementById("mc-inp");if(!inp)return;const text=inp.value.trim();if(!text)return;const db=DB.get();db.messages=db.messages||[];db.messages.push({id:"msg_"+Date.now(),fromUserId:CU.id,fromName:CU.name,toUserId:"admin",fromAdmin:false,text,date:new Date().toISOString(),readByUser:true,readByAdmin:false});DB.save(db);inp.value="";openThread();}
function openAlertModal(){const db=DB.get();const sel=document.getElementById("alert-coin");sel.innerHTML=db.coins.map(c=>`<option value="${c.id}">${c.name} (${c.symbol}) ‚Äî $${c.price.toFixed(4)}</option>`).join("");document.getElementById("alert-ovl").classList.add("show");}
function saveAlert(){const cid=gv("alert-coin"),dir=gv("alert-dir"),tp=parseFloat(gv("alert-price"));if(!cid||!tp||tp<=0)return toast("\u26a0\ufe0f","Enter a valid target price");const db=DB.get();const c=db.coins.find(x=>x.id===cid);if(!c)return;priceAlerts.push({id:"al_"+Date.now(),coinId:cid,coinName:c.name,symbol:c.symbol,color:c.color,dir,target:tp,created:new Date().toISOString(),triggered:false});localStorage.setItem("ncx_alerts",JSON.stringify(priceAlerts));document.getElementById("alert-ovl").classList.remove("show");document.getElementById("alert-price").value="";toast("\u2705","Alert set: "+c.symbol+" "+(dir==="above"?"above":"below")+" $"+tp.toFixed(4));renderAlerts();}
function chkAlerts(){const db=DB.get();let changed=false;priceAlerts.forEach(al=>{if(al.triggered)return;const c=db.coins.find(x=>x.id===al.coinId);if(!c)return;if((al.dir==="above"&&c.price>=al.target)||(al.dir==="below"&&c.price<=al.target)){al.triggered=true;changed=true;toast("\uD83D\uDD14",`${al.symbol} hit $${c.price.toFixed(4)}! (Target: $${al.target.toFixed(4)})`);setTimeout(()=>renderAlerts(),100);}});if(changed)localStorage.setItem("ncx_alerts",JSON.stringify(priceAlerts));}
function renderAlerts(){const el=document.getElementById("alerts-list");if(!el)return;const db=DB.get();if(!priceAlerts.length){el.innerHTML=`<div style="text-align:center;padding:40px 20px;color:var(--t4);font-size:.82rem;">No alerts set.<br>Create one to get notified when a coin hits your target.</div>`;return;}el.innerHTML=priceAlerts.slice().reverse().map(al=>{const c=db.coins.find(x=>x.id===al.coinId);const cp=c?c.price:0;return`<div class="alert-card ${al.triggered?"triggered":""}"><div style="width:34px;height:34px;border-radius:50%;background:${al.color||"#f0b90b"}18;display:flex;align-items:center;justify-content:center;font-size:1rem;flex-shrink:0;">${c?c.icon:""}</div><div style="flex:1;"><div style="font-weight:700;font-size:.85rem;">${al.symbol} ${al.dir==="above"?"‚ñ≤ above":"‚ñº below"} $${al.target.toFixed(4)}</div><div style="color:var(--t3);font-size:.73rem;">Current: $${cp.toFixed(4)} ¬∑ Created ${tAgo(al.created)}</div>${al.triggered?`<div style="color:var(--ye);font-size:.72rem;font-weight:700;margin-top:2px;">‚úì TRIGGERED</div>`:""}</div><div class="alert-del" onclick="delAlert('${al.id}')">üóë</div></div>`;}).join("");}
function delAlert(id){priceAlerts=priceAlerts.filter(a=>a.id!==id);localStorage.setItem("ncx_alerts",JSON.stringify(priceAlerts));renderAlerts();}
function renderProfile(){const av=CU.avatar?`<img src="${CU.avatar}" style="width:100%;height:100%;object-fit:cover;border-radius:50%;"/>`:CU.name[0];document.getElementById("prof-card").innerHTML=`<div class="pav-wrap"><div class="pav">${av}</div><div class="pav-edit" onclick="document.getElementById('pf-f').click()">‚úé</div></div><input type="file" id="pf-f" accept="image/*" style="display:none;" onchange="updAv(this)"/><div class="pname">${CU.name}</div><div class="pemail">${CU.email}</div><div style="margin-top:14px;"><div class="prow"><span class="pk">Phone</span><span class="pv">${CU.phone}</span></div><div class="prow"><span class="pk">Balance</span><span class="pv" style="color:var(--ye);">$${CU.balance.toFixed(2)}</span></div><div class="prow"><span class="pk">Joined</span><span class="pv">${new Date(CU.joined).toLocaleDateString()}</span></div></div>`;}
function updAv(inp){const f=inp.files[0];if(!f)return;const r=new FileReader();r.onload=e=>{CU.avatar=e.target.result;DB.saveUser(CU);renderProfile();toast("\u2705","Photo updated!");};r.readAsDataURL(f);}
function changePw(){const p1=gv("np1"),p2=gv("np2");if(!p1||p1.length<8)return toast("\u26a0\ufe0f","Min 8 characters");if(p1!==p2)return toast("\u26a0\ufe0f","Passwords don't match");CU.pw=p1;DB.saveUser(CU);toast("\u2705","Password updated!");}
function openDep(){depM=null;depDoc=null;depDocN=null;document.getElementById("dep-ovl").classList.add("show");depNext(1);document.querySelectorAll(".pmeth").forEach(e=>e.classList.remove("sel"));}
function closeDep(){document.getElementById("dep-ovl").classList.remove("show");}
function selPM(m){depM=m;document.getElementById("pm-fp").classList.toggle("sel",m==="fastpay");document.getElementById("pm-fib").classList.toggle("sel",m==="fib");}
function depNext(n){if(n===2&&!depM)return toast("\u26a0\ufe0f","Select a payment method");if(n===3){const amt=parseFloat(gv("dep-amt"))||0;const ph=gv("dep-phone").trim();if(amt<=0)return toast("\u26a0\ufe0f","Enter amount");if(!ph)return toast("\u26a0\ufe0f","Enter your phone number");document.getElementById("dep-acct-sub").textContent="via "+(depM==="fastpay"?"Fast Pay":"FIB");}if(n===4){if(!depDoc)return toast("\u26a0\ufe0f","Upload your receipt first");document.getElementById("sum-meth").textContent=depM==="fastpay"?"‚ö° Fast Pay":"üè¶ FIB";document.getElementById("sum-amt").textContent="$"+(parseFloat(gv("dep-amt"))||0).toFixed(2);document.getElementById("sum-doc").textContent=depDocN||"receipt";}[1,2,3,4].forEach(i=>{document.getElementById("dep"+i).style.display=i===n?"block":"none";const s=document.getElementById("ds"+i);s.classList.toggle("on",i===n);s.classList.toggle("done",i<n);});}
function handleDoc(inp){const f=inp.files[0];if(!f)return;if(f.size>10*1024*1024)return toast("\u26a0\ufe0f","Max 10MB");depDocN=f.name;const r=new FileReader();r.onload=e=>{depDoc=e.target.result;const z=document.getElementById("uzn");z.classList.add("has-file");document.getElementById("uz-fn").textContent="\u2713 "+f.name;document.getElementById("uz-fn").style.display="block";document.getElementById("uz-tx").textContent="Receipt uploaded!";document.getElementById("uz-ic").textContent="\u2705";};r.readAsDataURL(f);}
function submitDep(){const amt=parseFloat(gv("dep-amt"))||0;const phone=gv("dep-phone").trim();if(!depDoc)return toast("\u26a0\ufe0f","Upload receipt");const db=DB.get();db.deposits=db.deposits||[];db.deposits.push({id:"dep_"+Date.now(),userId:CU.id,userName:CU.name,userEmail:CU.email,phone,method:depM,amount:amt,status:"pending",docData:depDoc,docName:depDocN,date:new Date().toISOString()});DB.save(db);closeDep();toast("\uD83D\uDCE4","Deposit submitted! Awaiting admin review.");if(document.getElementById("pg-dashboard").classList.contains("on"))renderDB();}
function tAgo(date){const d=(Date.now()-new Date(date))/1000;if(d<60)return"now";if(d<3600)return Math.floor(d/60)+"m";if(d<86400)return Math.floor(d/3600)+"h";return Math.floor(d/86400)+"d";}
function escH(s){return s.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\\n/g,"<br>");}
const saved=localStorage.getItem("ncx_cu");
if(saved){CU=JSON.parse(saved);setTimeout(()=>{enterApp();const db=DB.get();if(db.coins.length>0){ensureC(db.coins[0]);DB.save(db);selCoin(db.coins[0].id);}},300);}
</script>
</body>
</html>